angular.module("app").directive("uiNav",["$timeout",function(e){return{restrict:"AC",link:function(e,a,t){var n,s=$(window),i=$(".app-aside");a.on("click","a",function(e){n&&n.trigger("mouseleave.nav");var a=$(this);a.parent().siblings(".active").toggleClass("active"),a.next().is("ul")&&a.parent().toggleClass("active")&&e.preventDefault(),a.next().is("ul")||s.width()<768&&$(".app-aside").removeClass("show off-screen")}),a.on("mouseenter","a",function(e){var a,t,o;n&&n.trigger("mouseleave.nav"),$("> .nav",i).remove(),!$(".app-aside-fixed.app-aside-folded").length||s.width()<768||$(".app-aside-dock").length||(a=$(e.target),o=$(window).height(),a.is("a")||(a=a.closest("a")),a.next().is("ul")&&(n=a.next(),a.parent().addClass("active"),t=a.parent().position().top+50,n.css("top",t),t+n.height()>o&&n.css("bottom",0),o<t+150&&n.css("bottom",o-t-50).css("top","auto"),n.appendTo(i),n.on("mouseleave.nav",function(e){$(".dropdown-backdrop").remove(),n.appendTo(a.parent()),n.off("mouseleave.nav").css("top","auto").css("bottom","auto"),a.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(e){e&&e.trigger("mouseleave.nav")})))}),i.on("mouseleave",function(e){n&&n.trigger("mouseleave.nav"),$("> .nav",i).remove()})}}}]);