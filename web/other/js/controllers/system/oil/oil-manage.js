app.controller("oilManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(n,a,s,i,o,t){n.selected_customerId="0",n.app.myData.customerListNoAll=n.app.myData.customerList.slice(0),"0"==n.app.myData.customerListNoAll[0].customerId&&n.app.myData.customerListNoAll.splice(0,1),0!=n.app.myData.role&&(n.selected_customerId=n.app.myData.customerListNoAll[0].customerId),n.default_search_select_station_list={stationId:"0",stationName:t.instant("public.all")},n.search_select_station_list=[n.default_search_select_station_list],n.selected_stationId="0",o.getStationListSendData.sessionId=n.app.myData.sessionId,n.callback_getStationList=function(t){n.search_select_station_list=n.search_select_station_list.concat(t.fieldValues),"0"!=n.selected_customerId?n.getOilListSendData.where=" customerId='"+n.selected_customerId+"'":n.getOilListSendData.where="",1!=n.pagingOptions.currentPage&&(n.pagingOptions.currentPage=1)},n.selectCustomerChange=function(){console.log(n.selected_customerId),n.search_select_station_list=[n.default_search_select_station_list],"0"!=n.selected_customerId?o.getStationListSendData.where=" customerId='"+n.selected_customerId+"'":o.getStationListSendData.where="",i.myPost2(o.URL.systemUrl,o.getStationListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,n.callback_getStationList)},1==n.app.myData.role&&n.selectCustomerChange(),n.selectStationChange=function(){console.log(n.selected_customerId),"0"!=n.selected_stationId?n.getOilListSendData.where=" stationId='"+n.selected_stationId+"'":"0"!=n.selected_customerId?n.getOilListSendData.where=" customerId='"+n.selected_customerId+"'":n.getOilListSendData.where="",1!=n.pagingOptions.currentPage?n.pagingOptions.currentPage=1:n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage)},n.getOilListSendData={sessionId:n.app.myData.sessionId,tableName:"view_oil_station",fields:[],where:"",limit:"",offset:""},n.filterOptions={filterText:"",useExternalFilter:!0},n.totalServerItems=0,n.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},n.columnDefs=[{field:"stationId",displayName:t.instant("items.stationManage.stationId"),width:"*"},{field:"stationName",displayName:t.instant("items.stationManage.stationName"),width:"*"},{field:"oilCode",displayName:t.instant("items.oilManage.oilCode"),width:"*"},{field:"oilName",displayName:t.instant("items.oilManage.oilName"),width:"*"},{field:"price",displayName:t.instant("items.oilManage.price"),width:"*"},{field:"createTime",displayName:t.instant("items.oilManage.createTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],n.callback=function(t){n.myData=t.fieldValues,n.totalServerItems=t.allCount,s.clear()},n.setPagingData=function(t,a){n.getOilListSendData.offset=1==t?0:(t-1)*a,n.getOilListSendData.limit=a,i.myPost2(o.URL.systemUrl,n.getOilListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,n.callback)},n.getPagedDataAsync=function(t,a,e){setTimeout(function(){s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.loadingData),n.setPagingData(a,t)},100)},n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage),n.$watch("pagingOptions",function(t,a){t!==a&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.$watch("filterOptions",function(t,a){t!==a&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.gridOptions={i18n:"undefined"!=n.app.myData.lang?n.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:n.pagingOptions,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:n.filterOptions},app.controller("btnClickAddOilCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,e,n){t.parent=n,t.info=e,t.customerListNoAll=n.app.myData.customerListNoAll,t.info.customerId=t.customerListNoAll[0].customerId,t.stationListNoAll=[],t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=o.cmdType.ADD,console.log(t.info),t.callback2=function(t){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.addSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.oilManageMsgId,o.msgIdName.oilManageMsgName,t.callback2,a),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.addingData)},t.cancel=function(){console.log(t.info),a.dismiss(0)}}]),n.btnClickAddOil=function(){a.open({templateUrl:"tpl/system/oil/addOil.html",controller:"btnClickAddOilCon",size:"md",resolve:{parentScope:n,info:{}}})},app.controller("btnClickEditOilCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,e,n){t.info=e,t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=o.cmdType.CHANGE,console.log(t.info),t.callback3=function(e){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.editSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),n.app.myData.stationList.forEach(function(t,a){t.stationId==e.stationId&&(n.app.myData.stationList[a].stationName=e.stationName)}),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.oilManageMsgId,o.msgIdName.oilManageMsgName,t.callback3,a),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.editingData)},t.cancel=function(){a.dismiss(0)}}]),n.btnClickEditOil=function(){var t=n.gridOptions.$gridScope.selectedItems;console.log(t[0]),0==t.length?s.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/oil/editOil.html",controller:"btnClickEditOilCon",size:"md",resolve:{parentScope:n,info:t[0]}})},app.controller("btnClickDelOilCon",["$scope","$uibModalInstance","info","parentScope",function(t,a,e,n){t.info=e,t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=o.cmdType.DEL,t.callback3=function(t){s.clear(),s.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.deleteSuccess,o.TIMEOUT.timeout1s),a.dismiss(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.oilManageMsgId,o.msgIdName.oilManageMsgName,t.callback3,a),s.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.deletingData)},t.cancel=function(){a.dismiss(0)}}]),n.btnClickDelOil=function(){var t=n.gridOptions.$gridScope.selectedItems;0==t.length?s.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/oil/delOil.html",controller:"btnClickDelOilCon",size:"md",resolve:{parentScope:n,info:t[0]}})}}]);