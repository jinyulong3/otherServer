app.controller("multimediadevicesManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(i,t,s,n,o,e){i.getMultimediadevicesListSendData={sessionId:i.app.myData.sessionId,tableName:"view_multimedia_devices_station_customer",fields:[],where:"",limit:"",offset:""},i.deviceTypes=[{id:1,name:"32吋屏"},{id:2,name:"15吋屏"},{id:3,name:"5.8吋屏"}],i.filterOptions={filterText:"",useExternalFilter:!0},i.totalServerItems=0,i.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},i.setPagingData=function(e,t){i.getMultimediadevicesListSendData.offset=1==e?0:(e-1)*t,i.getMultimediadevicesListSendData.limit=t,n.myPost2(o.URL.systemUrl,i.getMultimediadevicesListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,i.callback)},i.getPagedDataAsync=function(e,t,a){setTimeout(function(){s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.loadingData),i.setPagingData(t,e)},100)},i.selected_customerId="0",i.app.myData.customerListNoAll=i.app.myData.customerList.slice(0),"0"==i.app.myData.customerListNoAll[0].customerId&&i.app.myData.customerListNoAll.splice(0,1),0!=i.app.myData.role&&(i.selected_customerId=i.app.myData.customerListNoAll[0].customerId),i.default_search_select_station_list={stationId:"0",stationName:e.instant("public.all")},i.search_select_station_list=[i.default_search_select_station_list],i.selected_stationId="0",o.getStationListSendData.sessionId=i.app.myData.sessionId,i.callback_getStationList=function(e){i.search_select_station_list=i.search_select_station_list.concat(e.fieldValues),"0"!=i.selected_customerId?i.getMultimediadevicesListSendData.where=" customerId='"+i.selected_customerId+"'":i.getMultimediadevicesListSendData.where="",1!=i.pagingOptions.currentPage&&(i.pagingOptions.currentPage=1)},i.selectCustomerChange=function(){console.log(i.selected_customerId),i.search_select_station_list=[i.default_search_select_station_list],"0"!=i.selected_customerId?(o.getStationListSendData.where=" customerId='"+i.selected_customerId+"'",i.getMultimediadevicesListSendData.where=" customerId='"+i.selected_customerId+"'",i.pagingOptions.currentPage=1,i.app.myData.role<1&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage)):(o.getStationListSendData.where="",i.getMultimediadevicesListSendData.where="",i.pagingOptions.currentPage=1,i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage)),n.myPost2(o.URL.systemUrl,o.getStationListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,i.callback_getStationList)},1==i.app.myData.role&&i.selectCustomerChange(),i.selectStationChange=function(){console.log(i.selected_customerId),"0"!=i.selected_stationId?i.getMultimediadevicesListSendData.where=" stationId='"+i.selected_stationId+"'":"0"!=i.selected_customerId?i.getMultimediadevicesListSendData.where=" customerId='"+i.selected_customerId+"'":i.getMultimediadevicesListSendData.where="",1!=i.pagingOptions.currentPage?i.pagingOptions.currentPage=1:i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage)};i.columnDefs=[{field:"customerId",displayName:e.instant("items.customerManage.customerNo"),width:"*"},{field:"customerName",displayName:e.instant("items.customerManage.customerName"),width:"*"},{field:"stationId",displayName:e.instant("items.stationManage.stationId"),width:"*"},{field:"stationName",displayName:e.instant("items.stationManage.stationName"),width:"*"},{field:"deviceId",displayName:"多媒体屏编号",width:"*"},{field:"displayName",displayName:"多媒体屏名称",width:"*"},{field:"deviceType",displayName:"设备类型",cellFilter:"filterDeviceType",width:"*"},{field:"useEvaluate",displayName:"评价",cellFilter:"filterIsOrNotUsed",width:"*"},{field:"useShopping",displayName:"购物",cellFilter:"filterIsOrNotUsed",width:"*"},{field:"usePrize",displayName:"抽奖",cellFilter:"filterIsOrNotUsed",width:"*"},{field:"useMemberScore",displayName:"员工积分",cellFilter:"filterIsOrNotUsed",width:"*"},{field:"time_insert",displayName:"创建时间",width:"*",cellFilter:"filterDateStringSplitMs"}],i.callback=function(e){i.myData=e.fieldValues,i.totalServerItems=e.allCount,s.clear()},i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage),i.$watch("pagingOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.$watch("filterOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.gridOptions={i18n:"undefined"!=i.app.myData.lang?i.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:i.pagingOptions,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:i.filterOptions},app.controller("btnClickAddMultimediadevicesCon",["$scope","$uibModalInstance","info","parentScope",function(e,t,a,i){e.parent=i,e.info=a,e.customerListNoAll=i.app.myData.customerListNoAll,e.info.customerId=e.customerListNoAll[0].customerId,e.stationListNoAll=[],e.deviceTypes=i.deviceTypes,e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.ADD,e.info.usePrize=e.usePrize_bool?1:0,e.info.useEvaluate=e.useEvaluate_bool?1:0,e.info.useShopping=e.useShopping_bool?1:0,e.info.useMemberScore=e.useMemberScore_bool?1:0,e.callback2=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.addSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},n.myPost2(o.URL.systemUrl,e.info,o.msgIdName.manageMultimediadevicesMsgId,o.msgIdName.manageMultimediadevicesMsgName,e.callback2,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.addingData)},e.cancel=function(){console.log(e.info),t.dismiss(0)}}]),i.btnClickAddMultimediadevices=function(){t.open({templateUrl:"tpl/system/multimediadevices/addMultimediadevices.html",controller:"btnClickAddMultimediadevicesCon",size:"md",resolve:{parentScope:i,info:{}}})},app.controller("btnClickEditMultimediadevicesCon",["$scope","$uibModalInstance","info","parentScope",function(e,t,a,i){e.info=a,e.deviceTypes=i.deviceTypes,e.usePrize_bool=1==e.info.usePrize,e.useEvaluate_bool=1==e.info.useEvaluate,e.useShopping_bool=1==e.info.useShopping,e.useMemberScore_bool=1==e.info.useMemberScore,console.log(e.usePrize_bool),e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.CHANGE,e.info.usePrize=e.usePrize_bool?1:0,e.info.useEvaluate=e.useEvaluate_bool?1:0,e.info.useShopping=e.useShopping_bool?1:0,e.info.useMemberScore=e.useMemberScore_bool?1:0,console.log(e.info),e.callback3=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.editSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},n.myPost2(o.URL.systemUrl,e.info,o.msgIdName.manageMultimediadevicesMsgId,o.msgIdName.manageMultimediadevicesMsgName,e.callback3,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.editingData)},e.cancel=function(){t.dismiss(0)}}]),i.btnClickEditMultimediadevices=function(){var e=i.gridOptions.$gridScope.selectedItems;console.log(e[0]),0==e.length?s.pop("info",constantsLang[i.app.myData.lang].tips.tip,constantsLang[i.app.myData.lang].tips.noSelectRow):t.open({templateUrl:"tpl/system/multimediadevices/editMultimediadevices.html",controller:"btnClickEditMultimediadevicesCon",size:"md",resolve:{parentScope:i,info:e[0]}})},app.controller("btnClickDelMultimediadevicesCon",["$scope","$uibModalInstance","info","parentScope",function(e,t,a,i){e.info=a,e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.DEL,e.callback3=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.deleteSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},n.myPost2(o.URL.systemUrl,e.info,o.msgIdName.manageMultimediadevicesMsgId,o.msgIdName.manageMultimediadevicesMsgName,e.callback3,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.deletingData)},e.cancel=function(){t.dismiss(0)}}]),i.btnClickDelMultimediadevices=function(){var e=i.gridOptions.$gridScope.selectedItems;0==e.length?s.pop("info",constantsLang[i.app.myData.lang].tips.tip,constantsLang[i.app.myData.lang].tips.noSelectRow):t.open({templateUrl:"tpl/system/multimediadevices/delMultimediadevices.html",controller:"btnClickDelMultimediadevicesCon",size:"md",resolve:{parentScope:i,info:e[0]}})}}]);