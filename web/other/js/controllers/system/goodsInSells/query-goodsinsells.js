app.controller("queryGoodsInSells",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(i,e,n,a,s,t){i.myConstants=s,i.queryGoodsInSellsData={sessionId:i.app.myData.sessionId,customerId:"",stationId:"",deviceId:"",startTime:"2001-01-01",endTime:"2029-02-02",eventType:3,payType:0,limit:"",offset:""},i.payTypes=s.payTypes,i.eventTypes=s.eventTypes,i.filterOptions={filterText:"",useExternalFilter:!0},i.totalServerItems=0,i.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},i.columnDefs=[{field:"stationId",displayName:t.instant("items.stationManage.stationId"),width:"*"},{field:"deviceId",displayName:"设备编号",width:"*"},{field:"channelId",displayName:"货道号",width:"*"},{field:"channelName",displayName:"货道名称",width:"*"},{field:"goodId",displayName:"商品编号",width:"*"},{field:"goodName",displayName:"商品名称",width:"*"},{field:"goodCount",displayName:"商品个数",width:"*"},{field:"eventDateTime",displayName:"时间",width:"*",cellFilter:"filterDateStringSplitMs"},{field:"money",displayName:"金额",width:"*",cellFilter:"filterMoney"},{field:"payType",displayName:"支付方式",width:"*",cellFilter:"filterPayType:this"}],i.callback=function(e){i.myData=e.goodsInSellsList,i.totalServerItems=e.allCount,n.clear()},i.setPagingData=function(e,t){i.queryGoodsInSellsData.offset=1==e?0:(e-1)*t,i.queryGoodsInSellsData.limit=t,a.myPost2(s.URL.systemUrl,i.queryGoodsInSellsData,s.msgIdName.queryGoodsInSellsMsgId,s.msgIdName.queryGoodsInSellsMsgName,i.callback)},i.getPagedDataAsync=function(e,t,a){setTimeout(function(){n.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.loadingData),i.setPagingData(t,e)},100)},i.$watch("pagingOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.$watch("filterOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.gridOptions={i18n:"undefined"!=i.app.myData.lang?i.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:i.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,noUnselect:!0,filterOptions:i.filterOptions},i.goQuery=function(){var e,t;void 0!==i.info&&"undefined"!=i.info.customerId?(i.queryGoodsInSellsData.customerId=i.info.customerId,void 0!==i.info.stationId&&"0"!=i.queryGoodsInSellsData.stationId?(i.queryGoodsInSellsData.stationId=i.info.stationId,void 0!==i.info.deviceId&&"0"!=i.info.deviceId?(i.queryGoodsInSellsData.deviceId=i.info.deviceId,i.startDate=$("#startDate").val(),i.stopDate=$("#stopDate").val(),e="2019-01-01",t="2100-01-01",""!=i.startDate&&(e=i.startDate),""!=i.stopDate&&(t=i.stopDate),i.queryGoodsInSellsData.startTime=e,i.queryGoodsInSellsData.stopTime=t,i.getPagedDataAsync(i.pagingOptions.pageSize,1,i.filterOptions.filterText)):n.pop("info",constantsLang[i.app.myData.lang].tips.tip,"请选择售卖机")):n.pop("info",constantsLang[i.app.myData.lang].tips.tip,"请选择站点")):n.pop("info",constantsLang[i.app.myData.lang].tips.tip,"请选择客户")}}]);