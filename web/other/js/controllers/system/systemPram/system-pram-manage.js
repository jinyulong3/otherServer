app.controller("systemPramManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(s,e,n,i,o,t){s.selected_customerId="0",s.app.myData.customerListNoAll=s.app.myData.customerList.slice(0),console.log(s.app.myData.customerListNoAll),"0"==s.app.myData.customerListNoAll[0].customerId&&s.app.myData.customerListNoAll.splice(0,1),console.log(s.app.myData.customerListNoAll),s.default_search_select_station_list={stationId:"0",stationName:t.instant("public.all")},s.search_select_station_list=[s.default_search_select_station_list],s.selected_stationId="0",o.getStationListSendData.sessionId=s.app.myData.sessionId,0!=s.app.myData.role&&(s.selected_customerId=s.app.myData.customerListNoAll[0].customerId),console.log(s.app.myData.lang),s.callback_getStationList=function(t){s.search_select_station_list=s.search_select_station_list.concat(t.fieldValues),"0"!=s.selected_customerId?s.getSystemPramListSendData.where=" customerId='"+s.selected_customerId+"'":s.getSystemPramListSendData.where="",1!=s.pagingOptions.currentPage&&(s.pagingOptions.currentPage=1)},s.selectCustomerChange=function(){console.log(s.selected_customerId),s.search_select_station_list=[s.default_search_select_station_list],"0"!=s.selected_customerId?o.getStationListSendData.where=" customerId='"+s.selected_customerId+"'":o.getStationListSendData.where="",i.myPost2(o.URL.systemUrl,o.getStationListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,s.callback_getStationList)},1==s.app.myData.role&&s.selectCustomerChange(),s.selectStationChange=function(){console.log(s.selected_customerId),"0"!=s.selected_stationId?s.getSystemPramListSendData.where=" stationId='"+s.selected_stationId+"'":"0"!=s.selected_customerId?s.getSystemPramListSendData.where=" customerId='"+s.selected_customerId+"'":s.getSystemPramListSendData.where="",1!=s.pagingOptions.currentPage?s.pagingOptions.currentPage=1:s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage)},s.getSystemPramListSendData={sessionId:s.app.myData.sessionId,tableName:"view_systemparameters_station",fields:[],where:"",limit:"",offset:""},s.filterOptions={filterText:"",useExternalFilter:!0},s.totalServerItems=0,s.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},s.columnDefs=[{field:"stationId",displayName:t.instant("items.stationManage.stationId"),width:"*"},{field:"stationName",displayName:t.instant("items.stationManage.stationName"),width:"*"},{field:"moneyDec",displayName:t.instant("items.systemPramManage.moneyDec"),width:"*"},{field:"volumeDec",displayName:t.instant("items.systemPramManage.volumeDec"),width:"*"},{field:"totalizerDec",displayName:t.instant("items.systemPramManage.totalizerDec"),width:"*"},{field:"totalizer2Dec",displayName:t.instant("items.systemPramManage.totalizer2Dec"),width:"*"},{field:"heightDec",displayName:t.instant("items.systemPramManage.heightDec"),width:"*"},{field:"shiftCount",displayName:t.instant("items.systemPramManage.shiftCount"),width:"*"},{field:"createTime",displayName:t.instant("items.systemPramManage.createTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],s.callback=function(t){s.myData=t.fieldValues,s.totalServerItems=t.allCount,n.clear()},s.setPagingData=function(t,e){s.getSystemPramListSendData.offset=1==t?0:(t-1)*e,s.getSystemPramListSendData.limit=e,i.myPost2(o.URL.systemUrl,s.getSystemPramListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,s.callback)},s.getPagedDataAsync=function(t,e,a){setTimeout(function(){n.pop("wait",constantsLang[s.app.myData.lang].load.reqData,constantsLang[s.app.myData.lang].load.loadingData),s.setPagingData(e,t)},100)},s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage),s.$watch("pagingOptions",function(t,e){t!==e&&s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage,s.filterOptions.filterText)},!0),s.$watch("filterOptions",function(t,e){t!==e&&s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage,s.filterOptions.filterText)},!0),s.gridOptions={i18n:"undefined"!=s.app.myData.lang?s.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:s.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:s.filterOptions},app.controller("btnClickAddSystemPramCon",["$scope","$uibModalInstance","info","parentScope",function(t,e,a,s){t.type="noOilSel",t.parent=s,t.info=a,t.customerListNoAll=s.app.myData.customerListNoAll,t.info.customerId=t.customerListNoAll[0].customerId,t.ok=function(){t.info.sessionId=s.app.myData.sessionId,t.info.datatype=o.cmdType.ADD,console.log(t.info),t.callback2=function(t){n.clear(),n.pop("success",constantsLang[s.app.myData.lang].tips.success,constantsLang[s.app.myData.lang].tips.addSuccess,o.TIMEOUT.timeout1s),e.dismiss(0),s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage,s.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.systemPramManageMsgId,o.msgIdName.systemPramManageMsgName,t.callback2,e),n.pop("wait",constantsLang[s.app.myData.lang].load.reqData,constantsLang[s.app.myData.lang].load.addingData)},t.cancel=function(){e.dismiss(0)}}]),s.btnClickAddOil=function(){e.open({templateUrl:"tpl/system/systemPram/addSystemPram.html",controller:"btnClickAddSystemPramCon",size:"md",resolve:{parentScope:s,info:{}}})},app.controller("btnClickEditSystemPramCon",["$scope","$uibModalInstance","info","parentScope",function(t,e,a,s){t.info=a,t.ok=function(){t.info.sessionId=s.app.myData.sessionId,t.info.datatype=o.cmdType.CHANGE,console.log(t.info),t.callback3=function(a){n.clear(),n.pop("success",constantsLang[s.app.myData.lang].tips.success,constantsLang[s.app.myData.lang].tips.editSuccess,o.TIMEOUT.timeout1s),e.dismiss(0),s.app.myData.stationList.forEach(function(t,e){t.stationId==a.stationId&&(s.app.myData.stationList[e].stationName=a.stationName)}),s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage,s.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.systemPramManageMsgId,o.msgIdName.systemPramManageMsgName,t.callback3,e),n.pop("wait",constantsLang[s.app.myData.lang].load.reqData,constantsLang[s.app.myData.lang].load.editingData)},t.cancel=function(){e.dismiss(0)}}]),s.btnClickEditOil=function(){var t=s.gridOptions.$gridScope.selectedItems;console.log(t[0]),0==t.length?n.pop("info",constantsLang[s.app.myData.lang].tips.tip,constantsLang[s.app.myData.lang].tips.noSelectRow):e.open({templateUrl:"tpl/system/systemPram/editSystemPram.html",controller:"btnClickEditSystemPramCon",size:"md",resolve:{parentScope:s,info:t[0]}})},app.controller("btnClickDelSystemPramCon",["$scope","$uibModalInstance","info","parentScope",function(t,e,a,s){t.info=a,t.ok=function(){t.info.sessionId=s.app.myData.sessionId,t.info.datatype=o.cmdType.DEL,t.callback3=function(t){n.clear(),n.pop("success",constantsLang[s.app.myData.lang].tips.success,constantsLang[s.app.myData.lang].tips.deleteSuccess,o.TIMEOUT.timeout1s),e.dismiss(0),s.getPagedDataAsync(s.pagingOptions.pageSize,s.pagingOptions.currentPage,s.filterOptions.filterText)},i.myPost2(o.URL.systemUrl,t.info,o.msgIdName.systemPramManageMsgId,o.msgIdName.systemPramManageMsgName,t.callback3,e),n.pop("wait",constantsLang[s.app.myData.lang].load.reqData,constantsLang[s.app.myData.lang].load.deletingData)},t.cancel=function(){e.dismiss(0)}}]),s.btnClickDelOil=function(){var t=s.gridOptions.$gridScope.selectedItems;0==t.length?n.pop("info","提示","未选择行！"):e.open({templateUrl:"tpl/system/systemPram/delSystemPram.html",controller:"btnClickDelSystemPramCon",size:"md",resolve:{parentScope:s,info:t[0]}})}}]);