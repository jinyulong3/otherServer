app.controller("goodsclassManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(o,s,n,e,i,a){o.info={},o.info.classId0="0",o.info.classId1="0",o.info.classId2="0",o.show1=!1,o.show2=!1,o.parentClassId="0",o.selected_customerId=0,o.queryGoodsclassData={sessionId:o.app.myData.sessionId,customerId:"",parentClassId:"",limit:"",offset:""},o.filterOptions={filterText:"",useExternalFilter:!0},o.totalServerItems=0,o.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},o.columnDefs=[{field:"customerId",displayName:a.instant("items.customerManage.customerNo"),width:"*"},{field:"customerName",displayName:a.instant("items.customerManage.customerName"),width:"*"},{field:"classId",displayName:"商品类别编号",width:"*"},{field:"parentClassId",displayName:"上级类别编号",width:"*"},{field:"className",displayName:"商品类别名称",width:"*"},{field:"describe",displayName:"描述",width:"*"},{field:"time_insert",displayName:"插入时间",width:"*",cellFilter:"filterDateStringSplitMs"}],o.goQuery=function(){void 0===o.info||"undefined"==o.info.customerId?n.pop("info",constantsLang[o.app.myData.lang].tips.tip,"请选择客户"):(void 0===o.toQuery_parentClassId?o.queryGoodsclassData.parentClassId="0":o.queryGoodsclassData.parentClassId=o.toQuery_parentClassId,console.log(o.toQuery_parentClassId),o.queryGoodsclassData.customerId=o.info.customerId,o.getPagedDataAsync(o.pagingOptions.pageSize,o.pagingOptions.currentPage))},o.callback=function(a){o.myData=a.goodsclassList,o.totalServerItems=a.allCount,n.clear()},o.setPagingData=function(a,s){o.queryGoodsclassData.offset=1==a?0:(a-1)*s,o.queryGoodsclassData.limit=s,e.myPost2(i.URL.systemUrl,o.queryGoodsclassData,i.msgIdName.queryGoodsclassMsgId,i.msgIdName.queryGoodsclassMsgName,o.callback)},o.getPagedDataAsync=function(a,s,t){setTimeout(function(){n.pop("wait",constantsLang[o.app.myData.lang].load.reqData,constantsLang[o.app.myData.lang].load.loadingData),o.setPagingData(s,a)},100)},o.$watch("pagingOptions",function(a,s){a!==s&&o.getPagedDataAsync(o.pagingOptions.pageSize,o.pagingOptions.currentPage,o.filterOptions.filterText)},!0),o.$watch("filterOptions",function(a,s){a!==s&&o.getPagedDataAsync(o.pagingOptions.pageSize,o.pagingOptions.currentPage,o.filterOptions.filterText)},!0),o.gridOptions={i18n:"undefined"!=o.app.myData.lang?o.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:o.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:o.filterOptions},app.controller("btnClickAddGoodsclassCon",["$scope","$uibModalInstance","info","parentScope",function(s,t,a,o){s.info=a,console.log(s.info),void 0===o.toQuery_parentClassId?s.info.parentClassId="0":s.info.parentClassId=o.toQuery_parentClassId,s.ok=function(){s.info.sessionId=o.app.myData.sessionId,s.info.datatype=i.cmdType.ADD,s.callback2=function(a){n.clear(),n.pop("success",constantsLang[o.app.myData.lang].tips.success,constantsLang[o.app.myData.lang].tips.addSuccess,i.TIMEOUT.timeout1s),t.dismiss(0),o.selectCustomerChange(s.info.customerId)},e.myPost2(i.URL.systemUrl,s.info,i.msgIdName.manageGoodsclassMsgId,i.msgIdName.manageGoodsclassMsgName,s.callback2,t),n.pop("wait",constantsLang[o.app.myData.lang].load.reqData,constantsLang[o.app.myData.lang].load.addingData)},s.cancel=function(){console.log(s.info),t.dismiss(0)}}]),o.btnClickAddGoodsclass=function(){var a=o;void 0===o.info||"undefined"==o.info.customerId?n.pop("info",constantsLang[o.app.myData.lang].tips.tip,"请选择客户"):s.open({templateUrl:"tpl/system/goodsclass/addGoodsclass.html",controller:"btnClickAddGoodsclassCon",size:"md",resolve:{parentScope:a,info:o.info}})},app.controller("btnClickEditGoodsclassCon",["$scope","$uibModalInstance","info","parentScope",function(a,s,t,o){a.info=t,a.ok=function(){a.info.sessionId=o.app.myData.sessionId,a.info.datatype=i.cmdType.CHANGE,a.callback3=function(t){n.clear(),n.pop("success",constantsLang[o.app.myData.lang].tips.success,constantsLang[o.app.myData.lang].tips.editSuccess,i.TIMEOUT.timeout1s),s.dismiss(0),void 0!==o.app.myData.goodsclassList&&o.app.myData.goodsclassList.forEach(function(a,s){a.goodsclassId==t.goodsclassId&&(o.app.myData.goodsclassList[s].goodsclassName=t.goodsclassName)}),o.selectCustomerChange(a.info.customerId)},e.myPost2(i.URL.systemUrl,a.info,i.msgIdName.manageGoodsclassMsgId,i.msgIdName.manageGoodsclassMsgName,a.callback3,s),n.pop("wait",constantsLang[o.app.myData.lang].load.reqData,constantsLang[o.app.myData.lang].load.editingData)},a.cancel=function(){s.dismiss(0)}}]),o.btnClickEditGoodsclass=function(){var a=o.gridOptions.$gridScope.selectedItems;console.log(a[0]),0==a.length?n.pop("info",constantsLang[o.app.myData.lang].tips.tip,constantsLang[o.app.myData.lang].tips.noSelectRow):s.open({templateUrl:"tpl/system/goodsclass/editGoodsclass.html",controller:"btnClickEditGoodsclassCon",size:"md",resolve:{parentScope:o,info:a[0]}})},app.controller("btnClickDelGoodsclassCon",["$scope","$uibModalInstance","info","parentScope",function(s,t,a,o){s.info=a,s.ok=function(){s.info.sessionId=o.app.myData.sessionId,s.info.datatype=i.cmdType.DEL,s.callback3=function(a){n.clear(),n.pop("success",constantsLang[o.app.myData.lang].tips.success,constantsLang[o.app.myData.lang].tips.deleteSuccess,i.TIMEOUT.timeout1s),t.dismiss(0),o.selectCustomerChange(s.info.customerId)},e.myPost2(i.URL.systemUrl,s.info,i.msgIdName.manageGoodsclassMsgId,i.msgIdName.manageGoodsclassMsgName,s.callback3,t),n.pop("wait",constantsLang[o.app.myData.lang].load.reqData,constantsLang[o.app.myData.lang].load.deletingData)},s.cancel=function(){t.dismiss(0)}}]),o.btnClickDelGoodsclass=function(){var a=o.gridOptions.$gridScope.selectedItems;0==a.length?n.pop("info",constantsLang[o.app.myData.lang].tips.tip,constantsLang[o.app.myData.lang].tips.noSelectRow):s.open({templateUrl:"tpl/system/goodsclass/delGoodsclass.html",controller:"btnClickDelGoodsclassCon",size:"md",resolve:{parentScope:o,info:a[0]}})}}]);