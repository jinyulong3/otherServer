app.controller("nozzleManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(n,a,o,i,l,t){n.selected_customerId="0",n.app.myData.customerListNoAll=n.app.myData.customerList.slice(0),console.log(n.app.myData.customerListNoAll),"0"==n.app.myData.customerListNoAll[0].customerId&&n.app.myData.customerListNoAll.splice(0,1),console.log(n.app.myData.customerListNoAll),n.default_search_select_station_list={stationId:"0",stationName:t.instant("public.all")},n.search_select_station_list=[n.default_search_select_station_list],n.selected_stationId="0",l.getStationListSendData.sessionId=n.app.myData.sessionId,0!=n.app.myData.role&&(n.selected_customerId=n.app.myData.customerListNoAll[0].customerId),n.callback_getStationList=function(t){n.search_select_station_list=n.search_select_station_list.concat(t.fieldValues),"0"!=n.selected_customerId?n.getNozzleListSendData.where=" customerId='"+n.selected_customerId+"'":n.getNozzleListSendData.where="",1!=n.pagingOptions.currentPage&&(n.pagingOptions.currentPage=1)},n.selectCustomerChange=function(){console.log(n.selected_customerId),n.search_select_station_list=[n.default_search_select_station_list],"0"!=n.selected_customerId?l.getStationListSendData.where=" customerId='"+n.selected_customerId+"'":l.getStationListSendData.where="",i.myPost2(l.URL.systemUrl,l.getStationListSendData,l.msgIdName.normalSelectMsgId,l.msgIdName.normalSelectMsgName,n.callback_getStationList)},1==n.app.myData.role&&n.selectCustomerChange(),n.selectStationChange=function(){console.log(n.selected_customerId),"0"!=n.selected_stationId?n.getNozzleListSendData.where=" stationId='"+n.selected_stationId+"'":"0"!=n.selected_customerId?n.getNozzleListSendData.where=" customerId='"+n.selected_customerId+"'":n.getNozzleListSendData.where="",1!=n.pagingOptions.currentPage?n.pagingOptions.currentPage=1:n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage)},n.getNozzleListSendData={sessionId:n.app.myData.sessionId,tableName:"view_nozzle_tank_oil",fields:[],where:"",limit:"",offset:""},n.filterOptions={filterText:"",useExternalFilter:!0},n.totalServerItems=0,n.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},n.columnDefs=[{field:"stationId",displayName:t.instant("items.stationManage.stationId"),width:"*"},{field:"oilName",displayName:t.instant("items.oilManage.oilName"),width:"*"},{field:"nozzleNum",displayName:t.instant("items.nozzleManage.logicNozzleNo"),width:"*"},{field:"nozzleId",displayName:t.instant("items.nozzleManage.physicsNozzleNo"),width:"*"},{field:"oilCode",displayName:t.instant("items.oilManage.oilCode"),width:"*"},{field:"tankId",displayName:t.instant("items.tankManage.tankNo"),width:"*"},{field:"switchId",displayName:t.instant("items.switchManage.switchNo"),width:"*"},{field:"switchPort",displayName:t.instant("items.nozzleManage.switchPort"),width:"*"},{field:"createTime",displayName:t.instant("items.switchManage.createTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],n.callback=function(t){n.myData=t.fieldValues,n.totalServerItems=t.allCount,o.clear()},n.setPagingData=function(t,e){n.getNozzleListSendData.offset=1==t?0:(t-1)*e,n.getNozzleListSendData.limit=e,i.myPost2(l.URL.systemUrl,n.getNozzleListSendData,l.msgIdName.normalSelectMsgId,l.msgIdName.normalSelectMsgName,n.callback)},n.getPagedDataAsync=function(t,e,a){setTimeout(function(){o.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.loadingData),n.setPagingData(e,t)},100)},n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage),n.$watch("pagingOptions",function(t,e){t!==e&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.$watch("filterOptions",function(t,e){t!==e&&n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},!0),n.gridOptions={i18n:"undefined"!=n.app.myData.lang?n.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:n.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:n.filterOptions},app.controller("btnClickAddNozzleCon",["$scope","$uibModalInstance","info","parentScope",function(t,e,a,n){t.type2="nozzleManage",t.flag=1,t.parent=n,t.info=a,t.customerListNoAll=n.app.myData.customerListNoAll,t.info.customerId=t.customerListNoAll[0].customerId,t.stationListNoAll=[],t.oilTankListNoAll=[],t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=l.cmdType.ADD,console.log(t.info),t.callback2=function(t){o.clear(),o.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.addSuccess,l.TIMEOUT.timeout1s),e.dismiss(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},i.myPost2(l.URL.systemUrl,t.info,l.msgIdName.nozzleManageMsgId,l.msgIdName.nozzleManageMsgName,t.callback2,e),o.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.addingData)},t.cancel=function(){e.dismiss(0)}}]),n.btnClickAddOil=function(){a.open({templateUrl:"tpl/system/nozzle/addNozzle.html",controller:"btnClickAddNozzleCon",size:"md",resolve:{parentScope:n,info:{}}})},app.controller("btnClickEditNozzleCon",["$scope","$uibModalInstance","info","parentScope","$timeout",function(t,e,a,n,s){console.log(a),t.info=a,t.$timeout=s,t.parent=n,t.type2="nozzleManage",t.flag=2,t.customerListNoAll=n.app.myData.customerListNoAll,t.info.customerId=t.customerListNoAll[0].customerId,t.stationListNoAll=[],t.oilTankListNoAll=[],t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=l.cmdType.CHANGE,console.log(t.info),console.log(l.msgIdName.nozzleManageMsgId),t.callback3=function(t){o.clear(),o.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.editSuccess,l.TIMEOUT.timeout1s),e.dismiss(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},console.log(l.msgIdName.nozzleManageMsgName),i.myPost2(l.URL.systemUrl,t.info,l.msgIdName.nozzleManageMsgId,l.msgIdName.nozzleManageMsgName,t.callback3,e),o.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.editingData)},t.cancel=function(){e.close(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)}}]),n.btnClickEditOil=function(){var t=n,e=n.gridOptions.$gridScope.selectedItems;console.log(e[0]),0==e.length?o.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/nozzle/editNozzle.html",controller:"btnClickEditNozzleCon",size:"md",resolve:{parentScope:t,info:e[0]}})},app.controller("btnClickDelNozzleCon",["$scope","$uibModalInstance","info","parentScope","$timeout",function(t,e,a,n,s){t.info=a,t.$timeout=s,t.ok=function(){t.info.sessionId=n.app.myData.sessionId,t.info.datatype=l.cmdType.DEL,t.callback3=function(t){o.clear(),o.pop("success",constantsLang[n.app.myData.lang].tips.success,constantsLang[n.app.myData.lang].tips.deleteSuccess,l.TIMEOUT.timeout1s),e.dismiss(0),n.getPagedDataAsync(n.pagingOptions.pageSize,n.pagingOptions.currentPage,n.filterOptions.filterText)},i.myPost2(l.URL.systemUrl,t.info,l.msgIdName.nozzleManageMsgId,l.msgIdName.nozzleManageMsgName,t.callback3,e),o.pop("wait",constantsLang[n.app.myData.lang].load.reqData,constantsLang[n.app.myData.lang].load.deletingData)},t.cancel=function(){e.dismiss(0)}}]),n.btnClickDelOil=function(){var t=n.gridOptions.$gridScope.selectedItems;0==t.length?o.pop("info",constantsLang[n.app.myData.lang].tips.tip,constantsLang[n.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/nozzle/delNozzle.html",controller:"btnClickDelNozzleCon",size:"md",resolve:{parentScope:n,info:t[0]}})}}]);