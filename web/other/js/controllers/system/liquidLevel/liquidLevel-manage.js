app.controller("liquidLevelManage",["$scope","$uibModal","toaster","httpJsonHandle","myConstants","$translate",function(i,a,s,l,o,e){i.selected_customerId="0",i.app.myData.customerListNoAll=i.app.myData.customerList.slice(0),"0"==i.app.myData.customerListNoAll[0].customerId&&i.app.myData.customerListNoAll.splice(0,1),i.default_search_select_station_list={stationId:"0",stationName:e.instant("public.all")},i.search_select_station_list=[i.default_search_select_station_list],i.selected_stationId="0",o.getStationListSendData.sessionId=i.app.myData.sessionId,0!=i.app.myData.role&&(i.selected_customerId=i.app.myData.customerListNoAll[0].customerId),i.callback_getStationList=function(e){i.search_select_station_list=i.search_select_station_list.concat(e.fieldValues),"0"!=i.selected_customerId?i.getLiquidLevelListSendData.where=" customerId='"+i.selected_customerId+"'":i.getLiquidLevelListSendData.where="",1!=i.pagingOptions.currentPage&&(i.pagingOptions.currentPage=1)},i.selectCustomerChange=function(){console.log(i.selected_customerId),i.search_select_station_list=[i.default_search_select_station_list],"0"!=i.selected_customerId?o.getStationListSendData.where=" customerId='"+i.selected_customerId+"'":o.getStationListSendData.where="",l.myPost2(o.URL.systemUrl,o.getStationListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,i.callback_getStationList)},1==i.app.myData.role&&i.selectCustomerChange(),i.selectStationChange=function(){console.log(i.selected_customerId),"0"!=i.selected_stationId?i.getLiquidLevelListSendData.where=" stationId='"+i.selected_stationId+"'":"0"!=i.selected_customerId?i.getLiquidLevelListSendData.where=" customerId='"+i.selected_customerId+"'":i.getLiquidLevelListSendData.where="",1!=i.pagingOptions.currentPage?i.pagingOptions.currentPage=1:i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage)},i.getLiquidLevelListSendData={sessionId:i.app.myData.sessionId,tableName:"view_LiquidLevel_tank_oil",fields:[],where:"",limit:"",offset:""},i.filterOptions={filterText:"",useExternalFilter:!0},i.totalServerItems=0,i.pagingOptions={pageSizes:[10,15,25,50,100],pageSize:15,currentPage:1},i.columnDefs=[{field:"id",displayName:"ID",width:"*",visible:!0},{field:"stationId",displayName:e.instant("items.stationManage.stationId"),width:"*"},{field:"oilName",displayName:e.instant("items.oilManage.oilName"),width:"*"},{field:"agreementType",displayName:e.instant("items.liquidLevelManage.agreementType"),width:"*",cellFilter:"filterAgreementType:this"},{field:"oilCode",displayName:e.instant("items.oilManage.oilCode"),width:"*"},{field:"tankId",displayName:e.instant("items.tankManage.tankNo"),width:"*"},{field:"switchId",displayName:e.instant("items.switchManage.switchNo"),width:"*"},{field:"switchPort",displayName:e.instant("items.nozzleManage.switchPort"),width:"*"},{field:"createTime",displayName:e.instant("items.switchManage.createTime"),width:"*",cellFilter:"filterDateStringSplitMs"}],i.callback=function(e){i.myData=e.fieldValues,i.totalServerItems=e.allCount,s.clear()},i.setPagingData=function(e,t){i.getLiquidLevelListSendData.offset=1==e?0:(e-1)*t,i.getLiquidLevelListSendData.limit=t,l.myPost2(o.URL.systemUrl,i.getLiquidLevelListSendData,o.msgIdName.normalSelectMsgId,o.msgIdName.normalSelectMsgName,i.callback)},i.getPagedDataAsync=function(e,t,a){setTimeout(function(){s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.loadingData),i.setPagingData(t,e)},100)},i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage),i.$watch("pagingOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.$watch("filterOptions",function(e,t){e!==t&&i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},!0),i.gridOptions={i18n:"undefined"!=i.app.myData.lang?i.app.myData.lang:"zh-cn",data:"myData",enablePaging:!0,showFooter:!0,footerRowHeight:40,totalServerItems:"totalServerItems",pagingOptions:i.pagingOptions,enableColumnResizing:!0,rowHeight:28,enableRowSelection:!0,multiSelect:!1,columnDefs:"columnDefs",enableColumnResize:!0,showSelectionCheckbox:!0,filterOptions:i.filterOptions},app.controller("btnClickAddLiquidLevelCon",["$scope","$uibModalInstance","info","parentScope",function(e,t,a,i){e.type2="nozzleManage",e.flag=1,e.parent=i,e.info=a,e.customerListNoAll=i.app.myData.customerListNoAll,e.info.customerId=e.customerListNoAll[0].customerId,e.stationListNoAll=[],e.oilTankListNoAll=[],e.agreementTypes=o.agreementTypes,e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.ADD,e.callback2=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.addSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},l.myPost2(o.URL.systemUrl,e.info,o.msgIdName.liquidLevelManageMsgId,o.msgIdName.liquidLevelManageMsgName,e.callback2,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.addingData)},e.cancel=function(){t.dismiss(0)}}]),i.btnClickAddOil=function(){a.open({templateUrl:"tpl/system/liquidLevel/addLiquidLevel.html",controller:"btnClickAddLiquidLevelCon",size:"md",resolve:{parentScope:i,info:{}}})},app.controller("btnClickEditLiquidLevelCon",["$scope","$uibModalInstance","info","parentScope","$timeout",function(e,t,a,i,n){e.agreementTypes=o.agreementTypes,console.log(a),e.info=a,e.parent=i,e.type2="nozzleManage",e.flag=2,e.$timeout=n,e.customerListNoAll=i.app.myData.customerListNoAll,e.info.customerId=e.customerListNoAll[0].customerId,e.stationListNoAll=[],e.oilTankListNoAll=[],e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.CHANGE,e.callback3=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.editSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},l.myPost2(o.URL.systemUrl,e.info,o.msgIdName.liquidLevelManageMsgId,o.msgIdName.liquidLevelManageMsgName,e.callback3,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.editingData)},e.cancel=function(){t.close(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)}}]),i.btnClickEditOil=function(){var e=i,t=i.gridOptions.$gridScope.selectedItems;console.log(t[0]),0==t.length?s.pop("info",constantsLang[i.app.myData.lang].tips.tip,constantsLang[i.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/liquidLevel/editLiquidLevel.html",controller:"btnClickEditLiquidLevelCon",size:"md",resolve:{parentScope:e,info:t[0]}})},app.controller("btnClickDelLiquidLevelCon",["$scope","$uibModalInstance","info","parentScope",function(e,t,a,i){e.info=a,e.ok=function(){e.info.sessionId=i.app.myData.sessionId,e.info.datatype=o.cmdType.DEL,e.callback3=function(e){s.clear(),s.pop("success",constantsLang[i.app.myData.lang].tips.success,constantsLang[i.app.myData.lang].tips.deleteSuccess,o.TIMEOUT.timeout1s),t.dismiss(0),i.getPagedDataAsync(i.pagingOptions.pageSize,i.pagingOptions.currentPage,i.filterOptions.filterText)},l.myPost2(o.URL.systemUrl,e.info,o.msgIdName.liquidLevelManageMsgId,o.msgIdName.liquidLevelManageMsgName,e.callback3,t),s.pop("wait",constantsLang[i.app.myData.lang].load.reqData,constantsLang[i.app.myData.lang].load.deletingData)},e.cancel=function(){t.dismiss(0)}}]),i.btnClickDelOil=function(){var e=i.gridOptions.$gridScope.selectedItems;0==e.length?s.pop("info",constantsLang[i.app.myData.lang].tips.tip,constantsLang[i.app.myData.lang].tips.noSelectRow):a.open({templateUrl:"tpl/system/liquidLevel/delLiquidLevel.html",controller:"btnClickDelLiquidLevelCon",size:"md",resolve:{parentScope:i,info:e[0]}})}}]);