"use strict";app.controller("SigninFormController",["$rootScope","$scope","$state","$cookieStore","$uibModal","md5","httpJsonHandle","myConstants","myPublicMethod","$translate",function(a,t,o,e,s,n,r,p,d,m){t.user={},console.log(t.app.myData);var l=m.proposedLanguage()||m.use();t.app.myData.lang=void 0===l?"zh-cn":l,m.use(t.app.myData.lang),console.log(t.app.myData.lang),t.toEn=function(){m.use("en")},t.toZh=function(){m.use("zh-cn")},null!=t.app.myData.userId&&(t.user.userId=t.app.myData.userId,t.user.passWord=t.app.myData.passWord),t.login={},t.login.chk=!0,t.login.test="checked";var u=document.getElementById("rememberPswCheckBox");u.checked=!0,t.authError=null,t.login=function(){t.authError=null,t.validateCode()&&r.myPost(p.URL.systemUrl,t.user,p.msgIdName.loginMsgId).then(function(a){switch(console.log(a),a.data.resCode){case p.resCode.SUCCESS:!function(a){t.app.myData.name=a.data.data.name,t.app.myData.sessionId=a.data.data.sessionId,t.app.myData.role=a.data.data.role,t.app.myData.customerId=a.data.data.customerId,t.app.myData.customerName=a.data.data.customerName,t.app.myData.stationId=a.data.data.stationId,t.app.myData.stationName=a.data.data.stationName,t.app.myData.customerList=[],console.log(t.app.myData),u.checked?(t.app.myData.userId=t.user.userId,t.app.myData.passWord=t.user.passWord):(t.app.myData.userId=null,t.app.myData.passWord=null);t.app.myData.userId=t.user.userId,t.app.myData.oldPsw=t.user.passWord,console.log(t.app.myData),t.app.myData.customerListNoAll=[];var e={sessionId:t.app.myData.sessionId,tableName:"info_customer",fields:[],limit:2e3,offset:0};r.myPost2(p.URL.systemUrl,e,p.msgIdName.normalSelectMsgId,p.msgIdName.normalSelectMsgName,function(a){var e;t.app.myData.customerList=a.fieldValues,1<=a.fieldValues.length&&(e={customerId:"0",customerName:m.instant("public.all")},t.app.myData.customerList.unshift(e)),console.log("登陆后请求到客户列表",t.app.myData.customerList)}),o.go("app.main")}(a);default:t.createCode(4),t.authError=a.data.resMsg}},function(a){t.authError=constantsLang[t.app.myData.lang].tips.error,console.log(a)})},t.createCode=function(a){for(var e="",t=parseInt(a),o=document.getElementById("checkCode"),s=new Array(3,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f","g","h","j","k","b","m","n","h","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","J","K","B","M","N","H","P","Q","R","S","T","U","V","W","X","Y","Z"),n=0;n<t;n++){var r=s[Math.floor(62*Math.random())];void 0===r&&(r="a"),e+=r}o&&(o.className="code",o.innerHTML=e)},t.createCode(4),t.validateCode=function(){var a=document.getElementById("checkCode").innerHTML;return console.log(a),t.user.inputCode.length<=0?(t.authError=constantsLang[t.app.myData.lang].tips.inputValidateCode,!1):t.user.inputCode.toUpperCase()==a.toUpperCase()||(t.authError=constantsLang[t.app.myData.lang].tips.validateCodeError,t.createCode(4),!1)}}]);